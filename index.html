<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DocuSave Quiz</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: #1a1a1a; color: #fff; min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        
        .header { background: #e63946; padding: 20px; border-radius: 10px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.5rem; font-weight: bold; }
        .stats { display: flex; gap: 20px; }
        .stat { text-align: center; }
        .stat-value { font-size: 1.3rem; font-weight: bold; }
        
        .panel { background: #252525; padding: 30px; border-radius: 10px; margin-bottom: 20px; }
        
        .day-buttons { display: flex; gap: 15px; justify-content: center; margin: 30px 0; }
        .day-btn { padding: 20px 40px; font-size: 1.1rem; border: 2px solid #e63946; background: transparent; color: #e63946; border-radius: 10px; cursor: pointer; }
        .day-btn:hover { background: #e63946; color: white; }
        
        .form-group { margin-bottom: 20px; text-align: left; }
        .form-group label { display: block; margin-bottom: 8px; color: #ccc; }
        .form-group input { width: 100%; padding: 15px; border: 2px solid #444; border-radius: 8px; background: #1a1a1a; color: #fff; font-size: 1rem; }
        
        .btn { padding: 15px 40px; font-size: 1.1rem; background: #e63946; border: none; color: white; border-radius: 10px; cursor: pointer; margin-top: 10px; }
        .btn:hover { background: #c62d3a; }
        
        .answer-btn { display: block; width: 100%; padding: 20px; margin: 10px 0; font-size: 1rem; border: 2px solid #444; background: #1a1a1a; color: #fff; border-radius: 8px; cursor: pointer; text-align: left; }
        .answer-btn:hover { border-color: #e63946; }
        .answer-btn.correct { border-color: #4caf50; background: rgba(76,175,80,0.2); }
        .answer-btn.wrong { border-color: #f44336; background: rgba(244,67,54,0.2); }
        
        .hidden { display: none !important; }
        
        .feedback { margin-top: 20px; padding: 15px; border-radius: 8px; }
        .feedback.correct { background: rgba(76,175,80,0.2); border: 1px solid #4caf50; }
        .feedback.wrong { background: rgba(244,67,54,0.2); border: 1px solid #f44336; }
        
        .category { display: inline-block; padding: 5px 15px; background: #333; border-radius: 15px; font-size: 0.85rem; margin-bottom: 15px; color: #e63946; }
        .question { font-size: 1.3rem; margin-bottom: 25px; line-height: 1.5; }
        
        .progress { height: 6px; background: #333; border-radius: 3px; margin-bottom: 25px; }
        .progress-bar { height: 100%; background: #e63946; border-radius: 3px; transition: width 0.3s; }
        
        .result-score { font-size: 3rem; font-weight: bold; color: #e63946; margin: 20px 0; }
        
        .error { color: #f44336; margin-top: 10px; }
        
        /* Rangliste */
        .rangliste-panel {
            position: fixed;
            right: 20px;
            top: 100px;
            width: 250px;
            background: #252525;
            border-radius: 10px;
            padding: 20px;
        }
        .rangliste-panel h3 {
            margin-bottom: 15px;
            color: #e63946;
        }
        .rang-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #333;
            font-size: 0.9rem;
        }
        .rang-item span {
            color: #e63946;
            font-weight: bold;
        }
        
        @media (max-width: 1200px) {
            .rangliste-panel { display: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">üèõÔ∏è DocuSave Quiz</div>
            <div class="stats">
                <div class="stat">
                    <div>Punkte</div>
                    <div class="stat-value" id="score">0</div>
                </div>
                <div class="stat">
                    <div>Frage</div>
                    <div class="stat-value"><span id="qnum">0</span>/<span id="qtotal">0</span></div>
                </div>
            </div>
        </div>

        <!-- Rangliste Sidebar -->
        <div class="rangliste-panel" id="rangliste-panel">
            <h3>üèÜ Top 10</h3>
            <div id="rangliste"><p style="color:#999;">Laden...</p></div>
        </div>

        <!-- SCREEN 1: Tag w√§hlen -->
        <div class="panel" id="screen1">
            <h2 style="text-align:center; margin-bottom:10px;">W√§hle den Quiz-Tag</h2>
            <p style="text-align:center; color:#999; margin-bottom:20px;">Jeder Tag hat andere Fragen</p>
            <div class="day-buttons">
                <button class="day-btn" onclick="pickDay(1)">Tag 1<br><small>Leicht</small></button>
                <button class="day-btn" onclick="pickDay(2)">Tag 2<br><small>Mittel</small></button>
                <button class="day-btn" onclick="pickDay(3)">Tag 3<br><small>Schwer</small></button>
            </div>
        </div>

        <!-- SCREEN 2: Registrierung -->
        <div class="panel hidden" id="screen2">
            <h2 style="text-align:center; margin-bottom:20px;">Registrierung</h2>
            <div style="max-width:400px; margin:0 auto;">
                <div class="form-group">
                    <label>Vorname *</label>
                    <input type="text" id="fname" placeholder="Vorname">
                </div>
                <div class="form-group">
                    <label>Nachname *</label>
                    <input type="text" id="lname" placeholder="Nachname">
                </div>
                <div class="form-group">
                    <label>E-Mail *</label>
                    <input type="email" id="email" placeholder="email@beispiel.ch">
                </div>
                <div class="error hidden" id="error"></div>
                <button class="btn" onclick="startQuiz()" style="width:100%;">Quiz Starten</button>
            </div>
        </div>

        <!-- SCREEN 3: Frage -->
        <div class="panel hidden" id="screen3">
            <div class="progress"><div class="progress-bar" id="progressbar"></div></div>
            <div class="category" id="cat"></div>
            <div class="question" id="questiontext"></div>
            <div id="answers"></div>
            <div class="feedback hidden" id="feedback">
                <p id="feedbacktext"></p>
                <button class="btn" onclick="nextQ()">Weiter</button>
            </div>
        </div>

        <!-- SCREEN 4: Ergebnis -->
        <div class="panel hidden" id="screen4">
            <h2 style="text-align:center;">Quiz beendet!</h2>
            <div class="result-score" id="finalscore" style="text-align:center;">0</div>
            <p id="finalmsg" style="text-align:center; font-size:1.2rem; margin-bottom:20px;"></p>
            <p style="text-align:center; color:#999;">Vielen Dank f√ºr Ihre Teilnahme!</p>
        </div>
    </div>

<script>
// FRAGEN TAG 1 - 20 Fragen, Schwierigkeit 1-10
const day1 = [
    { cat: "Leicht", q: "Was m√∂gen Archivalien in der Regel am liebsten?", a: ["√úberraschungen", "Stabilit√§t", "H√§ufige Abwechslung"], c: 1, d: 1 },
    { cat: "Leicht", q: "Was ist der nat√ºrliche Feind jedes Archivs?", a: ["Kaffee", "Wasser", "Dunkelheit"], c: 1, d: 1 },
    { cat: "Leicht", q: "Was ist das docusave RescueKit Wasser?", a: ["Ein Notfallpaket f√ºr Bergung und Verpackung bei Wassersch√§den", "Ein digitales Archivsystem", "Ein Reparaturset f√ºr B√ºcher"], c: 0, d: 1 },
    { cat: "RescueKit", q: "Welche Komponente ist Bestandteil des RescueKits Wasser?", a: ["Pers√∂nliche Schutzausr√ºstung", "Luftentfeuchter und Ventilatoren", "docusave Verpackungskisten bis max. DIN-A3-Format"], c: 2, d: 1 },
    { cat: "RescueKit", q: "Warum ist die Einbettung des RescueKits Wasser in das docusave-Gesamtsystem pr√§ventiv und organisatorisch relevant?", a: ["Weil dadurch externe Dienstleister ausgeschlossen werden", "Weil ein strukturierter, reibungsloser √úbergang von der Bergung in die Wiederherstellungsphase gew√§hrleistet wird", "Weil dadurch keine weiteren Entscheidungen im Schadensfall n√∂tig sind"], c: 1, d: 2 },
    { cat: "RescueKit", q: "F√ºr welchen Umfang ist der Inhalt eines RescueKits Wasser ausgelegt?", a: ["F√ºr das Verpacken von bis zu 50 Laufmeter trockener oder wassergesch√§digter Dokumente", "F√ºr das Verpacken einzelner gesch√§digter Objekte", "F√ºr den vollst√§ndigen Inhalt eines durchschnittlichen Archivraums"], c: 0, d: 2 },
    { cat: "RescueKit", q: "Welcher Vorteil steht beim Einsatz des RescueKits Wasser im Ernstfall im Vordergrund?", a: ["Die vollst√§ndige Wiederherstellung des Bestandes ohne externe Unterst√ºtzung", "Die Reduktion administrativer Aufgaben nach Abschluss der Bergung", "Die sofortige Handlungsf√§higkeit durch verf√ºgbares, einsatzerprobtes Notfallmaterial"], c: 2, d: 3 },
    { cat: "RescueKit", q: "Warum ist der rasche Zugriff auf das RescueKit Wasser im Schadensfall entscheidend?", a: ["Weil geeignete Materialien und Verpackungstechniken Folgesch√§den bei Bergung und Transport reduzieren", "Weil nur in den ersten Stunden mikrobiologische Analysen m√∂glich sind", "Weil das Verpackungsmaterial des RescueKits nur unmittelbar nach einem Wasserschaden einsetzbar ist"], c: 0, d: 3 },
    { cat: "Notfallkonzept", q: "Welcher Bergungsgrundsatz ist korrekt?", a: ["Je mehr Personen an der Bergung beteiligt sind, desto schneller und sicherer kann das Material bewegt werden", "Je k√ºrzer die Wege und je weniger Personen das Material in die Hand nehmen m√ºssen, desto besser", "L√§ngere Transportwege innerhalb des Geb√§udes sind unproblematisch, solange das Material mehrfach umgepackt wird"], c: 1, d: 3 },
    { cat: "Pr√§vention", q: "Welche Aussage ist fachlich korrekt?", a: ["Raue Oberfl√§chen in Archivr√§umen sind pflegeleichter als glatte", "Glatte W√§nde, Decken und B√∂den reduzieren Staubablagerungen und erleichtern die Reinigung", "Die Wahl der Oberfl√§chenmaterialien beeinflusst prim√§r die Raum√§sthetik und spielt f√ºr die Pr√§vention eine untergeordnete Rolle"], c: 1, d: 4 },
    { cat: "Klima", q: "Welche Aussage entspricht pr√§ventiven Empfehlungen?", a: ["Fenster verbessern die Klimastabilit√§t durch nat√ºrliche L√ºftung", "R√§ume ohne Fenster oder Lichtsch√§chte sind aus konservatorischer Sicht zu bevorzugen", "Fenster sollten m√∂glichst gross dimensioniert sein, um den Bedarf an k√ºnstlichen Lichtquellen zu reduzieren"], c: 1, d: 4 },
    { cat: "Klima", q: "Welche Aussage zum Einsatz von Luftentfeuchtungsger√§ten trifft zu?", a: ["Luftentfeuchter ersetzen eine systematische Klima√ºberwachung", "Der Dauerbetrieb von Luftentfeuchtern ist immer konservatorisch optimal", "Luftentfeuchter k√∂nnen sinnvoll sein, um Spitzenwerte abzufedern, m√ºssen aber regelm√§ssig kontrolliert werden"], c: 2, d: 5 },
    { cat: "Klima", q: "Welche Massnahme gilt als bevorzugt zur Klimastabilisierung?", a: ["Permanente technische Vollklimatisierung aller Archivr√§ume", "Passive Klimasteuerung durch Temperieren und kontrollierte L√ºftung", "Ausschliesslicher Einsatz mobiler Entfeuchtungsger√§te"], c: 1, d: 5 },
    { cat: "RescueKit", q: "Welche Funktion erf√ºllt das Inventarisierungstool (EIS) im Kontext des RescueKits?", a: ["Es erm√∂glicht eine digitale Dokumentation des Bestandes w√§hrend der Bergung", "Es dient ausschliesslich der sp√§teren Restaurierungsplanung", "Es dient prim√§r der Schadenserfassung"], c: 0, d: 5 },
    { cat: "Klima", q: "Welche Aussage zur Klimaaufzeichnung ist korrekt?", a: ["Stichprobenartige Messungen reichen f√ºr eine Klimabeurteilung aus", "Klimadaten lassen sich ohne Erfahrung eindeutig interpretieren", "Nur eine permanente Klimaaufzeichnung macht Schwankungen nachvollziehbar und bewertbar"], c: 2, d: 6 },
    { cat: "Klima", q: "Welche Aussage zum Klima in Ausstellungsr√§umen ist korrekt?", a: ["Das Innenklima von Ausstellungsr√§umen ist unabh√§ngig vom Aussenklima", "Das Klima richtet sich ausschliesslich nach der technischen Ausstattung des Ausstellungsgeb√§udes", "Museumsbesuchende beeinflussen das Raumklima durch K√∂rperw√§rme und personenbedingte Feuchtigkeitsabgabe"], c: 2, d: 7 },
    { cat: "Klima", q: "Welche Aussage zur Lichteinwirkung auf Ausstellungsobjekte ist korrekt?", a: ["Direkte Lichteinstrahlung, insbesondere UV-Strahlung, ist m√∂glichst zu vermeiden", "Kurzwellige Strahlung ist f√ºr Archiv- und Museumsobjekte unproblematisch", "Bei einer kurzen Ausstellungsdauer ist eine hohe Beleuchtungsst√§rke unproblematisch"], c: 0, d: 7 },
    { cat: "Klima", q: "Welche Aussage zur Klimastabilit√§t ist korrekt?", a: ["Kurzfristige Schwankungen sind unproblematisch, solange die Jahresmittelwerte stimmen", "Besonders Schwankungen in kurzen Zeitintervallen sind aus konservatorischer Sicht kritisch", "H√§ufige Klimawechsel f√∂rdern die Anpassungsf√§higkeit der Materialien"], c: 1, d: 8 },
    { cat: "Sch√§dlinge", q: "Wof√ºr steht IPM?", a: ["Integrated Pest Management", "Integrated Preservation Maintenance", "Integrated Preventive Maintenance"], c: 0, d: 9 },
    { cat: "Klima", q: "Welche Aussage beschreibt das Verhalten anorganischer Materialien korrekt?", a: ["Sch√§den an Metall, z.B. an Metallgestellen, entstehen ausschliesslich durch direkte Wassereinwirkung", "Anorganische Materialien sind gegen√ºber klimatischen Schwankungen grunds√§tzlich unempfindlich", "Auch anorganische Materialien k√∂nnen bei ung√ºnstiger oder zu hoher Luftfeuchtigkeit Schaden nehmen"], c: 2, d: 10 }
];

// FRAGEN TAG 2 - 20 Fragen, Schwierigkeit 1-10
const day2 = [
    { cat: "Leicht", q: "Schimmelpilz w√§chst besonders gern im Archiv, wenn...", a: ["es trocken, sauber und k√ºhl ist", "Feuchtigkeit, Staub und Zeit zusammenkommen", "das Archiv selten betreten wird"], c: 1, d: 1 },
    { cat: "Leicht", q: "Was macht Archivalien wirklich nerv√∂s?", a: ["Besuchergruppen", "Pl√∂tzliche Klimaschwankungen", "Leise Gespr√§che"], c: 1, d: 1 },
    { cat: "Leicht", q: "Welche Aussage fasst Pr√§vention am besten zusammen?", a: ["Risiken fr√ºh erkennen und Sch√§den vermeiden", "Sch√§den schnell reparieren", "Abwarten und reagieren"], c: 0, d: 1 },
    { cat: "RescueKit", q: "Welche Aussage beschreibt den prim√§ren Zweck des RescueKits Wasser korrekt?", a: ["Es stellt grundlegendes Notfallmaterial f√ºr die Bergung und sachgerechte Verpackung bei Wassersch√§den bereit", "Es dient der vollst√§ndigen Wiederherstellung wassergesch√§digter Dokumente vor Ort", "Es ersetzt das Beiziehen spezialisierter Fachpersonen im Schadensfall"], c: 0, d: 2 },
    { cat: "RescueKit", q: "Unter welcher Voraussetzung ist die Nutzung des Inventarisierungstools EIS kostenlos?", a: ["Bei einmaliger Nutzung im Schadensfall", "Wenn docusave mit der weiteren Bearbeitung des wassergesch√§digten Materials beauftragt wird", "F√ºr alle Institutionen unabh√§ngig vom weiteren Vorgehen"], c: 1, d: 2 },
    { cat: "RescueKit", q: "Welche Aussage zur Lagerung eines RescueKits ist korrekt?", a: ["Das Kit sollte zentral im Verwaltungsgeb√§ude gelagert werden", "Es sollte in der N√§he des Archivs oder Depots an einem sicheren, rasch zug√§nglichen Ort aufbewahrt werden", "Das Kit darf aus Sicherheitsgr√ºnden nur extern gelagert werden"], c: 1, d: 3 },
    { cat: "RescueKit", q: "Was ist das Ziel des Einf√ºhrungsworkshops zum RescueKit Wasser?", a: ["Vermittlung restauratorischer Techniken", "Schulung zur baulichen Schadensanalyse", "Erlernen der korrekten Anwendung des Materials und des Inventarisierungstools"], c: 2, d: 3 },
    { cat: "Notfallkonzept", q: "Welche der folgenden Organisationen sind keine Blaulichtorganisationen?", a: ["Polizei und Katastrophenschutz", "Feuerwehr und Rettungsdienst", "Blaues Kreuz und Schweizerischer Verband f√ºr Konservierung und Restaurierung SKR"], c: 2, d: 4 },
    { cat: "Klima", q: "Welche Aussage ist korrekt?", a: ["Neubauten k√∂nnen unmittelbar nach Fertigstellung mit Archivgut best√ºckt werden", "Restfeuchte in Neubauten oder renovierten Altbauten kann das Risiko von Schimmelpilzbildung erh√∂hen", "Beton trocknet innerhalb weniger Wochen vollst√§ndig aus"], c: 1, d: 5 },
    { cat: "Klima", q: "Welche Aussage beschreibt das Verhalten organischer Materialien korrekt?", a: ["Organische Materialien reagieren kaum auf Schwankungen der Luftfeuchtigkeit", "Nur Papier reagiert auf Feuchte; Leder und Holz nicht", "Hygroskopische Materialien stehen in direkter Wechselwirkung mit der Luftfeuchtigkeit und ver√§ndern Volumen und Gewicht"], c: 2, d: 10 },
    { cat: "Klima", q: "Was ist der Taupunkt?", a: ["Die Temperatur, bei der Wasser gefriert", "Die Temperatur, bei der Luftfeuchtigkeit kondensiert", "Die optimale Lagertemperatur"], c: 1, d: 6 },
    { cat: "Pr√§vention", q: "Welches Risiko besteht bei schwankenden Temperaturen f√ºr gebundene B√ºcher?", a: ["Keine, B√ºcher sind robust", "Spannungen im Einband und Buchr√ºcken", "Nur √§sthetische Probleme"], c: 1, d: 6 },
    { cat: "Sch√§dlinge", q: "Welche Umgebungsbedingungen f√∂rdern einen Sch√§dlingsbefall?", a: ["K√ºhle, trockene R√§ume", "Warme, feuchte R√§ume mit organischem Material", "R√§ume mit viel Tageslicht"], c: 1, d: 7 },
    { cat: "Klima", q: "Was versteht man unter kontrollierter L√ºftung?", a: ["Fenster regelm√§ssig √∂ffnen", "Gezielte Luftzufuhr basierend auf Innen- und Aussenklima", "Dauerbetrieb von Ventilatoren"], c: 1, d: 7 },
    { cat: "Pr√§vention", q: "Warum sollten Archive nicht im Keller liegen?", a: ["Zu dunkel f√ºr die Arbeit", "Erh√∂htes Risiko f√ºr Wassersch√§den und Feuchtigkeit", "Zu weit von B√ºros entfernt"], c: 1, d: 8 },
    { cat: "Notfallkonzept", q: "Was ist die Goldene Regel bei Wassersch√§den an Papier?", a: ["Sofort mit F√∂hn trocknen", "Innerhalb von 48 Stunden stabilisieren oder einfrieren", "Eine Woche abwarten ob es trocknet"], c: 1, d: 9 },
    { cat: "Sch√§dlinge", q: "Welche Massnahme ist bei Sch√§dlingsbefall NICHT empfohlen?", a: ["Sofortige Quarant√§ne befallener Objekte", "Einsatz von Insektiziden direkt auf Archivalien", "Kontaktaufnahme mit Fachleuten"], c: 1, d: 9 },
    { cat: "Klima", q: "Was bedeutet Pufferwirkung bei Archivkartons?", a: ["Sie sch√ºtzen vor mechanischen Sch√§den", "Sie gleichen kurzfristige Klimaschwankungen aus", "Sie sind wasserdicht"], c: 1, d: 9 },
    { cat: "Sch√§dlinge", q: "Papierfischchen sind keine gern gesehenen G√§ste in Archiven, Bibliotheken und Museen. Wie viele Eier legt ein Weibchen j√§hrlich?", a: ["ca. 50 Eier", "ca. 100 Eier", "ca. 300 Eier"], c: 0, d: 10 },
    { cat: "Klima", q: "Was ist das Hauptproblem bei der Lagerung von Filmmaterial?", a: ["Zu schwer f√ºr Regale", "Essigsyndrom durch chemischen Zerfall", "Braucht zu viel Platz"], c: 1, d: 10 }
];

// FRAGEN TAG 3 - 20 Fragen, Schwierigkeit 1-10
const day3 = [
    { cat: "Leicht", q: "Warum beeinflussen Museumsbesuchende das Raumklima?", a: ["Sie √∂ffnen heimlich Fenster", "Sie geben W√§rme und Feuchtigkeit ab", "Sie bringen eigenes Licht mit"], c: 1, d: 1 },
    { cat: "Leicht", q: "Warum tickt die Uhr bei einem Wasserschaden?", a: ["Wegen der Versicherung", "Weil das Wasser von selbst wieder verschwindet", "Weil mit der Zeit zus√§tzliche Sch√§den entstehen k√∂nnen"], c: 2, d: 1 },
    { cat: "Leicht", q: "Warum m√∂gen Archive √úberraschungen nicht?", a: ["Sie enden oft in Notf√§llen", "Sie sind schlecht dokumentierbar", "Sie stehen nicht im Kalender"], c: 0, d: 1 },
    { cat: "Leicht", q: "Was ist im Falle eines Wasserschadens die schlechteste Strategie?", a: ["Ruhe bewahren", "Fachlich korrekt verpacken", "Wir schauen morgen mal"], c: 2, d: 1 },
    { cat: "Pr√§vention", q: "Welche Massnahme dient der Sch√§dlingspr√§vention?", a: ["Offene Fenster f√ºr Frischluft", "Regelm√§ssige Reinigung und Inspektion", "Erh√∂hung der Raumtemperatur"], c: 1, d: 4 },
    { cat: "Notfallkonzept", q: "Was sollte ein Notfallplan enthalten?", a: ["Nur Telefonnummern", "Klare Handlungsanweisungen und Verantwortlichkeiten", "Ausschliesslich Versicherungsinformationen"], c: 1, d: 5 },
    { cat: "Klima", q: "Warum ist eine stabile Luftfeuchtigkeit wichtig?", a: ["Wegen der Optik der R√§ume", "Um Materialspannungen und Schimmelbildung zu vermeiden", "F√ºr das Wohlbefinden der Mitarbeiter"], c: 1, d: 5 },
    { cat: "Klima", q: "Was bedeutet hygroskopisch im Archivkontext?", a: ["Materialien sind wasserdicht", "Materialien nehmen Feuchtigkeit aus der Luft auf", "Materialien sind feuerfest"], c: 1, d: 6 },
    { cat: "Pr√§vention", q: "Was ist bei der Lagerung von Archivalien zu beachten?", a: ["Direkter Bodenkontakt ist ideal", "Ausreichend Abstand zu Aussenw√§nden und Boden", "M√∂glichst dichte Packung spart Platz"], c: 1, d: 6 },
    { cat: "Klima", q: "Welche Temperatur wird f√ºr Archivr√§ume empfohlen?", a: ["√úber 25¬∞C f√ºr schnelles Trocknen", "Zwischen 16-20¬∞C", "Unter 10¬∞C f√ºr maximale Haltbarkeit"], c: 1, d: 7 },
    { cat: "Klima", q: "Welcher Faktor ist f√ºr die Langzeitlagerung von Archivalien besonders kritisch?", a: ["Die Raumgr√∂sse", "Konstante klimatische Bedingungen", "Die Anzahl der Regale"], c: 1, d: 7 },
    { cat: "Pr√§vention", q: "Was ist ein wichtiger Aspekt bei der Notfallvorsorge?", a: ["Spontane Reaktion im Ernstfall", "Regelm√§ssige Schulung des Personals", "Ausschliesslich externe Hilfe"], c: 1, d: 8 },
    { cat: "RescueKit", q: "Wann sollte der Inhalt eines RescueKits √ºberpr√ºft werden?", a: ["Nur nach einem Schadensfall", "Regelm√§ssig, mindestens j√§hrlich", "Nie, die Materialien sind unbegrenzt haltbar"], c: 1, d: 8 },
    { cat: "Pr√§vention", q: "Welcher Lux-Wert wird f√ºr lichtempfindliche Archivalien maximal empfohlen?", a: ["500 Lux", "50 Lux", "200 Lux"], c: 1, d: 9 },
    { cat: "Pr√§vention", q: "Welche relative Luftfeuchtigkeit gilt f√ºr Papierarchive als ideal?", a: ["70-80% rH", "45-55% rH", "30-35% rH"], c: 1, d: 9 },
    { cat: "Sch√§dlinge", q: "Papierfischchen sind keine gern gesehenen G√§ste in Archiven, Bibliotheken und Museen. Wie lange dauert die Entwicklungszeit vom Ei bis zum geschlechtsreifen Tier?", a: ["ca. 2 Wochen", "ca. 1 Jahr", "ca. 1,5 bis 3 Jahre"], c: 2, d: 10 },
    { cat: "Sch√§dlinge", q: "Welches Verfahren wird zur schonenden Sch√§dlingsbek√§mpfung eingesetzt?", a: ["Chemische Begasung", "Anoxie (Sauerstoffentzug)", "UV-Bestrahlung"], c: 1, d: 10 }
];

// GOOGLE SHEETS API
const SHEETS_URL = 'https://script.google.com/macros/s/AKfycbxFbpeOrSuodLoLUdbvaybYqtE289ZGKQ0XeIAYSFHByx67vcXZLcPWvf4E8j4-fq_9/exec';
let rangliste = [];

// Rangliste laden
async function loadRangliste() {
    try {
        const response = await fetch(SHEETS_URL);
        const data = await response.json();
        rangliste = data.sort((a, b) => b.punkte - a.punkte).slice(0, 10);
        displayRangliste();
    } catch (e) {
        console.log('Rangliste laden fehlgeschlagen:', e);
    }
}

// Ergebnis speichern
async function saveResult() {
    const maxPunkte = questions.length * 1000; // 1000 pro Frage maximal
    const prozent = Math.round(score / maxPunkte * 100);
    const dauerSekunden = Math.round((Date.now() - startTime) / 1000);
    const minuten = Math.floor(dauerSekunden / 60);
    const sekunden = dauerSekunden % 60;
    const dauerText = minuten + ':' + (sekunden < 10 ? '0' : '') + sekunden;
    
    const data = {
        vorname: document.getElementById('fname').value,
        nachname: document.getElementById('lname').value,
        email: document.getElementById('email').value,
        tag: currentDay,
        punkte: score,
        maxPunkte: maxPunkte,
        prozent: prozent,
        dauer: dauerText
    };
    
    try {
        await fetch(SHEETS_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        console.log('Ergebnis gespeichert');
        loadRangliste();
    } catch (e) {
        console.log('Speichern fehlgeschlagen:', e);
    }
}

// Rangliste anzeigen
function displayRangliste() {
    const div = document.getElementById('rangliste');
    if (!div) return;
    
    if (rangliste.length === 0) {
        div.innerHTML = '<p style="color:#999;">Noch keine Eintr√§ge</p>';
        return;
    }
    
    let html = '';
    rangliste.forEach((r, i) => {
        const medal = i === 0 ? 'ü•á' : i === 1 ? 'ü•à' : i === 2 ? 'ü•â' : (i + 1) + '.';
        html += `<div class="rang-item">${medal} <strong>${r.vorname} ${r.nachname ? r.nachname.charAt(0) + '.' : ''}</strong> <span>${r.punkte} Pkt</span></div>`;
    });
    div.innerHTML = html;
}

// SPIELLOGIK
let currentDay = 0;
let questions = [];
let qIndex = 0;
let score = 0;
let startTime = 0;
let questionStartTime = 0;

function pickDay(day) {
    currentDay = day;
    document.getElementById('screen1').classList.add('hidden');
    document.getElementById('screen2').classList.remove('hidden');
}

async function startQuiz() {
    const fn = document.getElementById('fname').value.trim();
    const ln = document.getElementById('lname').value.trim();
    const em = document.getElementById('email').value.trim().toLowerCase();
    
    if (!fn || !ln || !em) {
        document.getElementById('error').textContent = 'Bitte alle Felder ausf√ºllen';
        document.getElementById('error').classList.remove('hidden');
        return;
    }
    if (!em.includes('@')) {
        document.getElementById('error').textContent = 'Bitte g√ºltige E-Mail eingeben';
        document.getElementById('error').classList.remove('hidden');
        return;
    }
    
    // E-Mail √úberpr√ºfung gegen bereits gespielte
    document.getElementById('error').textContent = '√úberpr√ºfe E-Mail...';
    document.getElementById('error').classList.remove('hidden');
    
    try {
        const response = await fetch(SHEETS_URL);
        const data = await response.json();
        const emailExists = data.some(r => r.email && r.email.toLowerCase() === em);
        
        if (emailExists) {
            document.getElementById('error').textContent = 'Diese E-Mail hat bereits teilgenommen!';
            return;
        }
    } catch (e) {
        console.log('E-Mail Check fehlgeschlagen, fahre fort:', e);
    }
    
    document.getElementById('error').classList.add('hidden');
    
    // Fragen laden
    if (currentDay === 1) questions = [...day1];
    else if (currentDay === 2) questions = [...day2];
    else questions = [...day3];
    
    // Nach Schwierigkeit sortieren (einfach ‚Üí schwer)
    questions.sort((a, b) => a.d - b.d);
    
    document.getElementById('qtotal').textContent = questions.length;
    qIndex = 0;
    score = 0;
    
    document.getElementById('screen2').classList.add('hidden');
    document.getElementById('screen3').classList.remove('hidden');
    startTime = Date.now();
    showQuestion();
}

function showQuestion() {
    const q = questions[qIndex];
    document.getElementById('cat').textContent = q.cat;
    document.getElementById('questiontext').textContent = q.q;
    document.getElementById('qnum').textContent = qIndex + 1;
    document.getElementById('score').textContent = score;
    document.getElementById('progressbar').style.width = (qIndex / questions.length * 100) + '%';
    
    const div = document.getElementById('answers');
    div.innerHTML = '';
    q.a.forEach((ans, i) => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = ans;
        btn.onclick = () => answer(i);
        div.appendChild(btn);
    });
    
    document.getElementById('feedback').classList.add('hidden');
    
    // Timer f√ºr diese Frage starten
    questionStartTime = Date.now();
}

function answer(idx) {
    const q = questions[qIndex];
    const btns = document.querySelectorAll('.answer-btn');
    
    // Zeit berechnen
    const sekunden = Math.round((Date.now() - questionStartTime) / 1000);
    
    btns.forEach((btn, i) => {
        btn.onclick = null;
        if (i === q.c) btn.classList.add('correct');
        else if (i === idx) btn.classList.add('wrong');
    });
    
    const fb = document.getElementById('feedback');
    const fbt = document.getElementById('feedbacktext');
    
    if (idx === q.c) {
        // 1000 Punkte minus 20 pro Sekunde, minimum 100
        const punkte = Math.max(100, 1000 - (sekunden * 20));
        score += punkte;
        fb.className = 'feedback correct';
        fbt.textContent = '‚úì Richtig! +' + punkte + ' Punkte (' + sekunden + ' Sek.)';
    } else {
        fb.className = 'feedback wrong';
        fbt.textContent = '‚úó Falsch. Richtig w√§re: ' + q.a[q.c];
    }
    
    fb.classList.remove('hidden');
    document.getElementById('score').textContent = score;
}

function nextQ() {
    qIndex++;
    if (qIndex >= questions.length) {
        showResult();
    } else {
        showQuestion();
    }
}

function showResult() {
    document.getElementById('screen3').classList.add('hidden');
    document.getElementById('screen4').classList.remove('hidden');
    document.getElementById('finalscore').textContent = score + ' Punkte';
    
    const max = questions.reduce((s, q) => s + q.d * 10, 0);
    const pct = Math.round(score / max * 100);
    
    let msg;
    if (pct >= 90) msg = 'üèÜ Ausgezeichnet! Archiv-Experte!';
    else if (pct >= 70) msg = 'üéâ Sehr gut! Solides Wissen!';
    else if (pct >= 50) msg = 'üëç Gut! Noch Luft nach oben.';
    else msg = 'üìö Weiter lernen! Besuchen Sie unseren Stand.';
    
    document.getElementById('finalmsg').textContent = msg;
    
    // Ergebnis speichern
    saveResult();
}

// Beim Laden Rangliste holen
loadRangliste();
</script>
</body>
</html>
